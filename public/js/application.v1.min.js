var hermes=angular.module("hermes",["ui.router","ui.materialize"]);hermes.constant("config",{apiKey:"AIzaSyB5iw0dc-qipE6iIEeoezD2oetkHh0s8ls",databaseURL:"http://hermes.api.dev",usuarios:"/usuarios",equipos:"/equipos",servidores:"/servidores",switches:"/switches",puertos:"/puertos",vlans:"/vlans",version:"0.1.2"});hermes.constant("Switches",{general:"http://hermes.api.dev/switches",single:"http://hermes.api.dev/switches/"});hermes.constant("Servidores",{general:"http://hermes.api.dev/servidores",single:"http://hermes.api.dev/servidores/"});hermes.constant("Equipos",{general:"http://hermes.api.dev/equipos",single:"http://hermes.api.dev/equipos/"});hermes.constant("Puertos",{general:"http://hermes.api.dev/puertos",single:"http://hermes.api.dev/puertos/"});
hermes.config(function($stateProvider,$urlRouterProvider,$httpProvider){function wherever_we_are(are){var are=window.location;return are.origin+are.pathname}$urlRouterProvider.otherwise("/");$stateProvider.state("index",{url:"/",templateUrl:wherever_we_are()+"view/login.html",controller:"login_controller"}).state("login",{url:"/login",templateUrl:wherever_we_are()+"view/login.html",controller:"login_controller"}).state("forget",{url:"/forget",templateUrl:wherever_we_are()+"view/forget.html",controller:"forget_controller"}).state("register",{url:"/register",templateUrl:wherever_we_are()+"view/register.html",controller:"register_controller"}).state("dashboard",{url:"/dashboard",templateUrl:wherever_we_are()+"view/dashboard.html",controller:"dashboard_controller"}).state("servidores",{url:"/servidores",templateUrl:wherever_we_are()+"view/servidores.html",controller:"servidores_controller"}).state("switches",{url:"/switches",templateUrl:wherever_we_are()+"view/switches.html",controller:"switches_controller"}).state("equipos",{url:"/equipos",templateUrl:wherever_we_are()+"view/equipos.html",controller:"equipos_controller"}).state("settings",{url:"/settings",templateUrl:wherever_we_are()+"view/settings.html",controller:"settings_controller"}).state("profile",{url:"/me",templateUrl:wherever_we_are()+"view/profile.html",controller:"profile_controller"}).state("admin",{url:"/admin",templateUrl:wherever_we_are()+"view/admin.html",controller:"admin_controller"}).state("net",{url:"/conexiones",templateUrl:wherever_we_are()+"view/net.html",controller:"net_controller"}).state("single_switche",{url:"/switches/:id",templateUrl:wherever_we_are()+"view/single-switches.html",controller:"single_switches_controller"}).state("single_equipo",{url:"/equipos/:id",templateUrl:wherever_we_are()+"view/single-equipos.html",controller:"single_equipos_controller"}).state("single_servidores",{url:"/servidores/:id",templateUrl:wherever_we_are()+"view/single-servidores.html",controller:"single_servidores_controller"})});
hermes.controller("create_modal",function($scope){$(".button-create").sideNav({menuWidth:500,draggable:true})});
hermes.controller("dashboard_controller",function($scope,Progres,Query,Auth,Switches,Servidores,Equipos,Puertos){Auth.getUser(function(user){$scope.user=user.data;$scope.user.active=true});Query.getAll(Switches.general,function(switches){$scope.switches=switches.data;Progres.loaded()});Query.getAll(Servidores.general,function(servidores){$scope.servidores=servidores.data;Progres.loaded()});Query.getAll(Equipos.general,function(equipos){$scope.equipos=equipos.data;Progres.loaded()});Query.getAll(Puertos.general,function(puertos){$scope.puertos=puertos.data;Progres.loaded()});$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});
hermes.controller("equipos_controller",function($scope,Query,Equipos,Progres){Query.getAll(Equipos.general,function(equipos){$scope.equipos=equipos.data;Progres.loaded()});$scope.equipo={};$scope.crearEquipos=function(datos){Query.sendNudes(Equipos.general,datos)};$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});
hermes.controller("forget_controller",function($scope,$location,$window){console.log("Recuperar la contrase√±a de los usuarios")});
hermes.controller("indexController",function(Session){Session.state()});
hermes.controller("login_controller",function(config,$scope,$window){console.info("%c Hermes","color:#3f51b5;font-size:3.2em;");localStorage.setItem("id","118")});
hermes.controller("nav",function($scope,$window,Session){$scope.logout=function(){Session.destroyUser;$window.location.href="#/"}});
hermes.controller("net_controller",function($scope,$location,$window,Progres,Query,config){console.log("Anidaciones para siempre")});
hermes.controller("profile_controller",function($scope,Progres,Auth){Auth.getUser(function(user){$scope.user=user.data;$scope.user.active=true;Progres.loaded()});$scope.updateInfoUser=function(datos){Auth.updateUser(datos);Progres.loaded()}});
hermes.controller("register_controller",function($scope,Progres,Auth,$location,Query,config){function randomString(){var text=" ";var posissible="ABCDFGHIJKLMNOPQRSTUVWXYZabcdfghijklmnopqrstuvwxyz";for(var i=0;i<32;i++)text+=posissible.charAt(Math.floor(Math.random()*posissible.length));return text}$scope.user={super_permission:0,remember_token:randomString()};$scope.resgiterUser=function(user){Progres.progressloading();Auth.register($scope.user);Progres.loaded()}});
hermes.controller("servidores_controller",function($scope,Progres,Servidores,Query){Query.getAll(Servidores.general,function(servidores){$scope.servidores=servidores.data;Progres.loaded()});$scope.servidor={};$scope.crearServidor=function(datos){Query.sendNudes(Servidores.general,datos)};$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});
hermes.controller("settings_controller",function($scope,$location,$window,Progres,Query,config){console.log("Configuraciones")});
hermes.controller("single_equipos_controller",function($scope,Query,Equipos,$stateParams,Progres){var ruta=Equipos.single+$stateParams.id;Query.getAll(ruta,function(equipo){$scope.equipo=equipo.data;Progres.loaded()});$scope.update=function(datos){Progres.progressloading();Query.updateDates(ruta,datos)};$scope.delete=function(){Progres.progressloading();Query.killme(ruta)};$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});
hermes.controller("single_servidores_controller",function($scope,$stateParams,Progres,Query,Servidores){var ruta=Servidores.single+$stateParams.id;Query.getAll(ruta,function(servidor){$scope.servidor=servidor.data;Progres.loaded()});$scope.update=function(datos){Progres.progressloading();Query.updateDates(ruta,datos)};$scope.delete=function(){Progres.progressloading();Query.killme(ruta)};$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});
hermes.controller("single_switches_controller",function($scope,Switches,$stateParams,Progres,Query){var ruta=Switches.single+$stateParams.id;Query.getAll(ruta,function(sw){$scope.switche=sw.data;Progres.loaded()});$scope.update=function(datos){Progres.progressloading();Query.updateDates(ruta,datos)};$scope.delete=function(){Progres.progressloading();Query.killme(ruta)};$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});hermes.controller("switches_puertos_equipos",function($scope,Switches,$stateParams,Progres,Query,config){var ruta=Switches.single+$stateParams.id+config.puertos;Query.getAll(ruta,function(puertosFrist){var puertos=new Array;var obtenerDatos=function(url){var consulta=$.ajax({url:url,async:false,success:function(success){puertos.push(success.data)}});return consulta};for(var i=0;i<puertosFrist.data.length;i++){obtenerDatos(config.databaseURL+config.puertos+"/"+puertosFrist.data[i].id+config.equipos)}var puertosEquipos={all:puertos};$scope.puertosEquipos=puertosEquipos.all;Progres.loaded()});$scope.PuertoEquipo=function(relation){Query.relation($stateParams.id,relation.element2,relation.element1)}});
hermes.controller("switches_controller",function($scope,Switches,Progres,Query){Query.getAll(Switches.general,function(switches){$scope.switches=switches.data;Progres.loaded()});$scope.sw={};$scope.crearSW=function(datos){Query.sendNudes(Switches.general,datos)};$scope.verModulos=function(){Materialize.toast("Esta funcion aun no esta lista",4e3)}});
hermes.service("Auth",function($http,$window,$location,config){this.setUserId=function(id){this.user=id};this.getUser=function(success,failure){$http.get(config.databaseURL+config.usuarios+"/"+this.user).success(success).error(failure)};this.updateUser=function(datos){$http({url:config.databaseURL+config.usuarios+"/"+this.user,method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(datos)}).success(function(success){Materialize.toast("Los datos de usuario fueron actualizados",4e3);$(".progress-update").addClass("hide")}).error(function(error){Materialize.toast("Ocurrio un error al actualizar tus datos",4e3);console.log(JSON.stringify(error))})};this.login=function(success,failure){$http.get(config.databaseURL+config.usuarios+"1").success(success).error(failure)};this.register=function(user,success,failure){$http({url:config.databaseURL+config.usuarios,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(user)}).then(function(response){$(".progress-update").addClass("hide");Materialize.toast("El usuario fue creado",4e3);var u=response.data.data;$window.location.href="#/dashboard";localStorage.setItem("id",u.id);localStorage.setItem("token",u.remember_token);localStorage.setItem("state","active")},function(response){Materialize.toast("Ocurrio un error al crear el usuario",4e3);console.log(JSON.stringify(response))})}});
hermes.service("materialize",function(){$(".button-edit").sideNav({menuWidth:600,edge:"left",draggable:true});$("select").material_select();$(".dropdown-button").dropdown()});
hermes.service("Progres",function(){this.progressloading=function(argument){$(".progress-update").removeClass("hide")};this.progressloaded=function(argument){$(".progress-update").addClass("hide")};this.loaded=function(argument){$(".load").addClass("hide");$(".table__content").removeClass("hide");$(".btn").removeClass("disabled");$(".progress-load").addClass("hide")};this.itsClear=function(argument){$(".loadClear").removeClass("hide")};this.fuckMenSalioMal=function(argument){$(".loadError").removeClass("hide")}});
hermes.service("Query",function($http,$window,config){this.getAll=function(urlDefine,success,failure){$http.get(urlDefine).success(success).error(failure)};this.sendNudes=function(urlDefine,datos){$http({url:urlDefine,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(datos)}).then(function(response){Materialize.toast("El elemento fue creado",4e3);console.log(JSON.stringify(response))},function(response){Materialize.toast("Ocurrio un error al crear el elemento",4e3);console.log(JSON.stringify(response))})};this.updateDates=function(urlDefine,datos){$http({url:urlDefine,method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(datos)}).success(function(success){Materialize.toast("Tu elemento fue actualizado",4e3);$(".progress-update").addClass("hide")}).error(function(error){Materialize.toast("Ocurrio un error al actualizar el elemento",4e3);console.log(JSON.stringify(error))})};this.killme=function(urlDefine){$http.delete(urlDefine).success(function(success){Materialize.toast("El elemento fue eliminado",4e3);console.log(success)}).error(function(error){Materialize.toast("Ocurrio un error al eliminar el elemento",4e3);console.log(error)})};this.relation=function(switche,puerto,equipo){$http({url:config.databaseURL+config.switches+"/"+switche+config.puertos+"/"+puerto,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(response){Materialize.toast("Se activo el puerto "+puerto+" del switche "+switche,4e3);console.log(JSON.stringify(response))},function(response){Materialize.toast("Ocurrio un error al activar el puerto "+puerto+" con el switche "+switche,4e3);console.log(JSON.stringify(response));console.log(response.status)});$http({url:config.databaseURL+config.equipos+"/"+equipo+config.puertos+"/"+puerto,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(response){Materialize.toast("Se conecto el equipo "+equipo+" al puerto "+puerto,4e3);console.log(JSON.stringify(response))},function(response){console.log(JSON.stringify(response));console.log(response.status)})}});
hermes.service("Session",function($http,$window,config,Auth){this.userId=localStorage.id;Auth.setUserId(this.userId);this.state=function(){var opciones=[undefined,"number","string"];if(typeof this.userId==opciones[0]||this.userId===undefined){this.destroyUser();$window.location.href="#/";console.warn("No tienes los permisos")}else{console.info("Session estable")}};this.saveUser=function(userId){Auth.getUser(function(userId){var u=userId.data;localStorage.setItem("name",u.name);localStorage.setItem("mail",u.mail);localStorage.setItem("id",u.id);localStorage.setItem("state","active");localStorage.setItem("token",u.remember_token)})};this.destroyUser=function(userId){localStorage.removeItem("id");localStorage.removeItem("name");localStorage.removeItem("mail");localStorage.removeItem("state");localStorage.removeItem("token");Materialize.toast("Necesitas iniciar sesion para obtener tus credenciales",4e3)}});
if(navigator.serviceWorker){navigator.serviceWorker.register("sw.js").then(function(registration){console.log("ServiceWorker registration successful with scope:",registration.scope)}).catch(function(error){console.log("ServiceWorker registration failed:",error)})}
